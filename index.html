<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Adam Fix Store</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(270deg, #ff7eb3, #ff758c, #42a5f5, #7e57c2);
      background-size: 800% 800%;
      animation: glimmer 15s ease infinite;
      color: white;
      text-align: center;
    }

    @keyframes glimmer {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    h1, h2 {
      text-shadow: 0 0 15px rgba(255,255,255,0.8);
    }

    form {
      margin: 20px auto;
      background: rgba(0,0,0,0.4);
      padding: 20px;
      border-radius: 12px;
      max-width: 400px;
    }

    input, textarea, select {
      width: 90%;
      padding: 10px;
      margin: 8px 0;
      border: none;
      border-radius: 6px;
      font-size: 14px;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .buy-btn {
      background: #2ecc71;
      color: white;
    }

    .clear-btn {
      background: #e74c3c;
      color: white;
      margin-top: 10px;
    }

    /* Success popup */
    #success-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #2ecc71;
      color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
      font-size: 18px;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <h1>Adam Fix Store</h1>

  <form id="order-form">
    <select name="item" required>
      <option value="">-- Select Item --</option>
      <option value="Calculator">Calculator - 987 EGP</option>
      <option value="Gun Toy">Gun Toy - 100 EGP</option>
      <option value="Toy Car">Toy Car - 200 EGP</option>
    </select>
    <input type="text" name="cash" placeholder="Cash Amount" required>
    <input type="text" name="address" placeholder="Address" required>
    <input type="text" name="number" placeholder="Phone Number" required>
    <input type="email" name="user_email" placeholder="Your Email" required>
    <textarea name="message" placeholder="Message (optional)"></textarea>
    <button type="submit" class="buy-btn">Buy</button>
  </form>

  <!-- Success popup -->
  <div id="success-popup">‚úÖ Order placed! Check your email.</div>

  <h2>Your Order History</h2>
  <div id="history"></div>
  <button onclick="clearHistory()" class="clear-btn">üóëÔ∏è Clear History</button>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function() {
      emailjs.init("h0dABymW32jwHiXli"); // Your Public Key
    })();

    const form = document.getElementById("order-form");
    const popup = document.getElementById("success-popup");

    form.addEventListener("submit", function(e) {
      e.preventDefault();

      emailjs.sendForm("service_fdy3h4j", "template_s37d2qa", this)
        .then(() => {
          showPopup();
          saveOrderHistory({
            item: form.item.value,
            cash: form.cash.value,
            address: form.address.value,
            number: form.number.value,
            email: form.user_email.value,
            message: form.message.value,
            date: new Date().toLocaleString()
          });
          form.reset();
        }, (err) => {
          alert("Error: " + JSON.stringify(err));
        });
    });

    function showPopup() {
      popup.style.display = "block";
      setTimeout(() => { popup.style.display = "none"; }, 4000);
    }

    function saveOrderHistory(order) {
      let history = JSON.parse(localStorage.getItem("adamfix_orders")) || [];
      history.push(order);
      localStorage.setItem("adamfix_orders", JSON.stringify(history));
      renderHistory();
    }

    function renderHistory() {
      const historyDiv = document.getElementById("history");
      const history = JSON.parse(localStorage.getItem("adamfix_orders")) || [];
      
      if (history.length === 0) {
        historyDiv.innerHTML = "<p>No orders yet.</p>";
        return;
      }

      historyDiv.innerHTML = history.map((o, i) => `
        <div style="background:rgba(0,0,0,0.4); padding:10px; margin:6px; border-radius:6px; text-align:left;">
          <strong>Order #${i+1}</strong><br>
          Item: ${o.item} (${o.cash})<br>
          Email: ${o.email}<br>
          Address: ${o.address}<br>
          Phone: ${o.number}<br>
          Message: ${o.message || "‚Äî"}<br>
          Date: ${o.date}
        </div>
      `).join("");
    }

    function clearHistory() {
      localStorage.removeItem("adamfix_orders");
      renderHistory();
    }

    // Render existing history on page load
    renderHistory();
  </script>
</body>
</html>
